from etlController import ETLController
from ruleController import RuleController
import argparse

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("-d", "--data", help="path to the data file", required=True)
    parser.add_argument("-st","--start", help="from which data number", required=True)
    parser.add_argument("-sp","--span", help="span of data", required=True)
    parser.add_argument("-r","--rule", help="path to the rule file", required=True)

    args = parser.parse_args()
    rules = RuleController()
    rules.createTextRule("uid",5,10,[',', '^','=','<'])
    rules.createTextRule("firstname",0,10,[])
    rules.createTextRule("secondname",0,10,[])
    rules.createTextRule("lastname",0,10,[])
    rules.createNumberRule("income",500,5000)
    rules.createNumberRule("id0",500,5000)
    rules.createNumberRule("id1",500,5000)
    rules.createNumberRule("id2",500,5000)
    rules.createNumberRule("id3",500,5000)
    rules.createNumberRule("id4",500,5000)
    rules.createNumberRule("id5",500,5000)
    rules.createNumberRule("id6",500,5000)
    rules.createNumberRule("id7",500,5000)
    rules.createNumberRule("id8",500,5000)
    rules.createNumberRule("id9",500,5000)
    rules.createNumberRule("id10",500,5000)
    rules.createNumberRule("id11",500,5000)
    rules.createNumberRule("id12",500,5000)
    rules.createNumberRule("id13",500,5000)
    rules.createNumberRule("id14",500,5000)
    rules.createNumberRule("id15",500,5000)
    rules.createNumberRule("id16",500,5000)
    rules.createNumberRule("id17",500,5000)
    rules.createNumberRule("id18",500,5000)
    rules.createNumberRule("id19",500,5000)
    rules.createNumberRule("id20",500,5000)
    rules.createNumberRule("id21",500,5000)
    rules.createNumberRule("id22",500,5000)
    rules.createNumberRule("id23",500,5000)
    rules.createNumberRule("id24",500,5000)
    rules.createNumberRule("id25",500,5000)
    rules.createNumberRule("id26",500,5000)
    rules.createNumberRule("id27",500,5000)
    rules.createNumberRule("id28",500,5000)
    rules.createNumberRule("id29",500,5000)
    rules.createNumberRule("id30",500,5000)
    rules.createNumberRule("id31",500,5000)
    rules.createNumberRule("id32",500,5000)
    rules.createNumberRule("id33",500,5000)
    rules.createNumberRule("id34",500,5000)
    rules.createNumberRule("id35",500,5000)
    rules.createNumberRule("id36",500,5000)
    rules.createNumberRule("id37",500,5000)
    rules.createNumberRule("id38",500,5000)
    rules.createNumberRule("id39",500,5000)
    rules.createNumberRule("id40",500,5000)
    rules.createNumberRule("id41",500,5000)
    rules.createNumberRule("id42",500,5000)
    rules.createNumberRule("id43",500,5000)
    rules.createNumberRule("id44",500,5000)
    rules.createNumberRule("id45",500,5000)
    rules.createNumberRule("id46",500,5000)
    rules.createNumberRule("id47",500,5000)
    rules.createNumberRule("id48",500,5000)
    rules.createNumberRule("id49",500,5000)
    rules.createNumberRule("id1",500,5000)
    rules.createTextRule("char0",0,10,['@'])
    rules.createTextRule("char1",0,10,['@'])
    rules.createTextRule("char2",0,10,['@'])
    rules.createTextRule("char3",0,10,['@'])
    rules.createTextRule("char4",0,10,['@'])
    rules.createTextRule("char5",0,10,['@'])
    rules.createTextRule("char6",0,10,['@'])
    rules.createTextRule("char7",0,10,['@'])
    rules.createTextRule("char8",0,10,['@'])
    rules.createTextRule("char9",0,10,['@'])
    rules.createTextRule("char10",0,10,['@'])
    rules.createTextRule("char11",0,10,['@'])
    rules.createTextRule("char12",0,10,['@'])
    rules.createTextRule("char13",0,10,['@'])
    rules.createTextRule("char14",0,10,['@'])
    rules.createTextRule("char15",0,10,['@'])
    rules.createTextRule("char16",0,10,['@'])
    rules.createTextRule("char17",0,10,['@'])
    rules.createTextRule("char18",0,10,['@'])
    rules.createTextRule("char19",0,10,['@'])
    rules.createTextRule("char20",0,10,['@'])
    rules.createTextRule("char21",0,10,['@'])
    rules.createTextRule("char22",0,10,['@'])
    rules.createTextRule("char23",0,10,['@'])
    rules.createTextRule("char24",0,10,['@'])
    rules.createTextRule("char25",0,10,['@'])
    rules.createTextRule("char26",0,10,['@'])
    rules.createTextRule("char27",0,10,['@'])
    rules.createTextRule("char28",0,10,['@'])
    rules.createTextRule("char29",0,10,['@'])
    rules.createTextRule("char30",0,10,['@'])
    rules.createTextRule("char31",0,10,['@'])
    rules.createTextRule("char32",0,10,['@'])
    rules.createTextRule("char33",0,10,['@'])
    rules.createTextRule("char34",0,10,['@'])
    rules.createTextRule("char35",0,10,['@'])
    rules.createTextRule("char36",0,10,['@'])
    rules.createTextRule("char37",0,10,['@'])
    rules.createTextRule("char38",0,10,['@'])
    rules.createTextRule("char39",0,10,['@'])
    rules.createTextRule("char40",0,10,['@'])
    rules.createTextRule("char41",0,10,['@'])
    rules.createTextRule("char42",0,10,['@'])
    rules.createTextRule("char43",0,10,['@'])
    rules.createTextRule("char44",0,10,['@'])
    rules.createTextRule("char45",0,10,['@'])
    rules.createTextRule("char46",0,10,['@'])
    rules.createTextRule("char47",0,10,['@'])
    rules.createTextRule("char48",0,10,['@'])
    rules.createTextRule("char49",0,10,['@'])
    rules.createRulesFile(args.rule)

    ETL = ETLController()
    ETL.setRules(args.data, args.rule)
    ETL.runRules(args.data,args.start,args.span)

if __name__ == '__main__':
    main()
